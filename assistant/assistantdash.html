<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medical Assistant Dashboard</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      /* Login Page */
      .login-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      .login-box {
        background: white;
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        width: 100%;
        max-width: 400px;
      }

      .login-box h2 {
        color: #667eea;
        margin-bottom: 30px;
        text-align: center;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 500;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
        transition: border-color 0.3s;
      }

      .form-group input:focus {
        outline: none;
        border-color: #667eea;
      }

      .btn {
        width: 100%;
        padding: 12px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s;
      }

      .btn:hover {
        transform: translateY(-2px);
      }

      /* Dashboard */
      .dashboard {
        display: none;
        min-height: 100vh;
      }

      .dashboard.active {
        display: block;
      }

      .header {
        background: white;
        padding: 20px 40px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .header h1 {
        color: #667eea;
        font-size: 24px;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .user-info span {
        color: #333;
        font-weight: 500;
      }

      .logout-btn {
        padding: 8px 20px;
        background: #ff4757;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
      }

      .logout-btn:hover {
        background: #ff3838;
      }

      .main-content {
        padding: 30px 40px;
      }

      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
        background: white;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .tab-btn {
        padding: 12px 30px;
        background: transparent;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        color: #666;
        transition: all 0.3s;
      }

      .tab-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .section-card {
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
      }

      .section-header h2 {
        color: #333;
        font-size: 22px;
      }

      .add-btn {
        padding: 10px 25px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .add-btn:hover {
        background: #764ba2;
      }

      /* Table Styles */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      th {
        background: #f8f9fa;
        padding: 15px;
        text-align: left;
        color: #333;
        font-weight: 600;
        border-bottom: 2px solid #e0e0e0;
      }

      td {
        padding: 15px;
        border-bottom: 1px solid #f0f0f0;
        color: #666;
      }

      tr:hover {
        background: #f8f9fa;
      }

      .action-btns {
        display: flex;
        gap: 8px;
      }

      .edit-btn,
      .delete-btn {
        padding: 6px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 500;
      }

      .edit-btn {
        background: #ffa502;
        color: white;
      }

      .delete-btn {
        background: #ff4757;
        color: white;
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .modal.active {
        display: flex;
      }

      .modal-content {
        background: white;
        padding: 30px;
        border-radius: 15px;
        width: 90%;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .modal-header h3 {
        color: #333;
      }

      .close-btn {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #999;
      }

      .modal-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .form-row {
        display: flex;
        flex-direction: column;
      }

      .form-row label {
        margin-bottom: 5px;
        color: #333;
        font-weight: 500;
      }

      .form-row input,
      .form-row select,
      .form-row textarea {
        padding: 10px;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        font-size: 14px;
      }

      .form-row input:focus,
      .form-row select:focus,
      .form-row textarea:focus {
        outline: none;
        border-color: #667eea;
      }

      .form-actions {
        display: flex;
        gap: 10px;
        margin-top: 10px;
      }

      .submit-btn,
      .cancel-btn {
        flex: 1;
        padding: 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
      }

      .submit-btn {
        background: #667eea;
        color: white;
      }

      .cancel-btn {
        background: #e0e0e0;
        color: #666;
      }

      .badge {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
      }

      .badge-success {
        background: #2ecc71;
        color: white;
      }

      .badge-warning {
        background: #f39c12;
        color: white;
      }

      .badge-danger {
        background: #e74c3c;
        color: white;
      }

      .empty-state {
        text-align: center;
        padding: 40px;
        color: #999;
      }

      @media (max-width: 768px) {
        .main-content {
          padding: 20px;
        }

        .header {
          padding: 15px 20px;
          flex-direction: column;
          gap: 15px;
        }

        .tabs {
          flex-direction: column;
        }

        table {
          font-size: 14px;
        }

        th,
        td {
          padding: 10px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
      <div class="login-box">
        <h2>üè• Assistant Login</h2>
        <form id="loginForm">
          <div class="form-group">
            <label>Email</label>
            <input
              type="email"
              id="loginEmail"
              required
              placeholder="Enter your email"
            />
          </div>
          <div class="form-group">
            <label>Password</label>
            <input
              type="password"
              id="loginPassword"
              required
              placeholder="Enter your password"
            />
          </div>
          <button type="submit" class="btn">Login</button>
        </form>
        <p
          style="
            text-align: center;
            margin-top: 15px;
            color: #999;
            font-size: 13px;
          "
        >
          Demo: assistant@clinic.com / password123
        </p>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
      <div class="header">
        <h1>üè• Medical Assistant Dashboard</h1>
        <div class="user-info">
          <span id="userName">Welcome, Assistant</span>
          <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
      </div>

      <div class="main-content">
        <div class="tabs">
          <button class="tab-btn active" onclick="switchTab('patients')">
            Patients
          </button>
          <button class="tab-btn" onclick="switchTab('appointments')">
            Appointments
          </button>
          <button class="tab-btn" onclick="switchTab('doctors')">
            My Doctors
          </button>
        </div>

        <!-- Patients Tab -->
        <div id="patientsTab" class="tab-content active">
          <div class="section-card">
            <div class="section-header">
              <h2>Patient Management</h2>
              <button class="add-btn" onclick="openPatientModal()">
                + Add Patient
              </button>
            </div>
            <table id="patientsTable">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Age</th>
                  <th>Phone</th>
                  <th>Email</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="patientsBody"></tbody>
            </table>
          </div>
        </div>

        <!-- Appointments Tab -->
        <div id="appointmentsTab" class="tab-content">
          <div class="section-card">
            <div class="section-header">
              <h2>Appointment Management</h2>
              <button class="add-btn" onclick="openAppointmentModal()">
                + Add Appointment
              </button>
            </div>
            <table id="appointmentsTable">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Patient</th>
                  <th>Doctor</th>
                  <th>Date</th>
                  <th>Time</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="appointmentsBody"></tbody>
            </table>
          </div>
        </div>

        <!-- Doctors Tab -->
        <div id="doctorsTab" class="tab-content">
          <div class="section-card">
            <div class="section-header">
              <h2>My Assigned Doctors</h2>
              <button class="add-btn" onclick="openDoctorModal()">
                + Assign Doctor
              </button>
            </div>
            <table id="doctorsTable">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Doctor Name</th>
                  <th>Specialization</th>
                  <th>Phone</th>
                  <th>Email</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="doctorsBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Patient Modal -->
    <div id="patientModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="patientModalTitle">Add Patient</h3>
          <button class="close-btn" onclick="closePatientModal()">
            &times;
          </button>
        </div>
        <form id="patientForm" class="modal-form">
          <input type="hidden" id="patientId" />
          <div class="form-row">
            <label>Full Name *</label>
            <input type="text" id="patientName" required />
          </div>
          <div class="form-row">
            <label>Age *</label>
            <input type="number" id="patientAge" required min="1" />
          </div>
          <div class="form-row">
            <label>Phone *</label>
            <input type="tel" id="patientPhone" required />
          </div>
          <div class="form-row">
            <label>Email *</label>
            <input type="email" id="patientEmail" required />
          </div>
          <div class="form-row">
            <label>Address</label>
            <textarea id="patientAddress" rows="3"></textarea>
          </div>
          <div class="form-actions">
            <button type="submit" class="submit-btn">Save Patient</button>
            <button
              type="button"
              class="cancel-btn"
              onclick="closePatientModal()"
            >
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Appointment Modal -->
    <div id="appointmentModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="appointmentModalTitle">Add Appointment</h3>
          <button class="close-btn" onclick="closeAppointmentModal()">
            &times;
          </button>
        </div>
        <form id="appointmentForm" class="modal-form">
          <input type="hidden" id="appointmentId" />
          <div class="form-row">
            <label>Patient *</label>
            <select id="appointmentPatient" required></select>
          </div>
          <div class="form-row">
            <label>Doctor *</label>
            <select id="appointmentDoctor" required></select>
          </div>
          <div class="form-row">
            <label>Date *</label>
            <input type="date" id="appointmentDate" required />
          </div>
          <div class="form-row">
            <label>Time *</label>
            <input type="time" id="appointmentTime" required />
          </div>
          <div class="form-row">
            <label>Status *</label>
            <select id="appointmentStatus" required>
              <option value="Scheduled">Scheduled</option>
              <option value="Confirmed">Confirmed</option>
              <option value="Completed">Completed</option>
              <option value="Cancelled">Cancelled</option>
            </select>
          </div>
          <div class="form-row">
            <label>Notes</label>
            <textarea id="appointmentNotes" rows="3"></textarea>
          </div>
          <div class="form-actions">
            <button type="submit" class="submit-btn">Save Appointment</button>
            <button
              type="button"
              class="cancel-btn"
              onclick="closeAppointmentModal()"
            >
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Doctor Modal -->
    <div id="doctorModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="doctorModalTitle">Assign Doctor</h3>
          <button class="close-btn" onclick="closeDoctorModal()">
            &times;
          </button>
        </div>
        <form id="doctorForm" class="modal-form">
          <input type="hidden" id="doctorId" />
          <div class="form-row">
            <label>Doctor Name *</label>
            <input type="text" id="doctorName" required />
          </div>
          <div class="form-row">
            <label>Specialization *</label>
            <input type="text" id="doctorSpecialization" required />
          </div>
          <div class="form-row">
            <label>Phone *</label>
            <input type="tel" id="doctorPhone" required />
          </div>
          <div class="form-row">
            <label>Email *</label>
            <input type="email" id="doctorEmail" required />
          </div>
          <div class="form-actions">
            <button type="submit" class="submit-btn">Save Doctor</button>
            <button
              type="button"
              class="cancel-btn"
              onclick="closeDoctorModal()"
            >
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      // Data Storage
      let patients = [
        {
          id: 1,
          name: "John Smith",
          age: 45,
          phone: "555-0101",
          email: "john@email.com",
          address: "123 Main St",
        },
        {
          id: 2,
          name: "Sarah Johnson",
          age: 32,
          phone: "555-0102",
          email: "sarah@email.com",
          address: "456 Oak Ave",
        },
      ];

      let appointments = [
        {
          id: 1,
          patientId: 1,
          doctorId: 1,
          date: "2025-11-05",
          time: "10:00",
          status: "Scheduled",
          notes: "Regular checkup",
        },
        {
          id: 2,
          patientId: 2,
          doctorId: 2,
          date: "2025-11-06",
          time: "14:30",
          status: "Confirmed",
          notes: "Follow-up visit",
        },
      ];

      let doctors = [
        {
          id: 1,
          name: "Dr. Michael Brown",
          specialization: "Cardiology",
          phone: "555-0201",
          email: "mbrown@clinic.com",
        },
        {
          id: 2,
          name: "Dr. Emily Davis",
          specialization: "Pediatrics",
          phone: "555-0202",
          email: "edavis@clinic.com",
        },
      ];

      let currentUser = null;
      let editingPatient = null;
      let editingAppointment = null;
      let editingDoctor = null;

      // Login Functionality
      document
        .getElementById("loginForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const email = document.getElementById("loginEmail").value;
          const password = document.getElementById("loginPassword").value;

          // Simple authentication (in real app, this would be server-side)
          if (email === "assistant@clinic.com" && password === "password123") {
            currentUser = { name: "Medical Assistant", email: email };
            document.getElementById("loginPage").style.display = "none";
            document.getElementById("dashboard").classList.add("active");
            document.getElementById(
              "userName"
            ).textContent = `Welcome, ${currentUser.name}`;
            loadAllData();
          } else {
            alert(
              "Invalid credentials! Use: assistant@clinic.com / password123"
            );
          }
        });

      function logout() {
        currentUser = null;
        document.getElementById("dashboard").classList.remove("active");
        document.getElementById("loginPage").style.display = "flex";
        document.getElementById("loginForm").reset();
      }

      // Tab Switching
      function switchTab(tabName) {
        document
          .querySelectorAll(".tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".tab-content")
          .forEach((content) => content.classList.remove("active"));

        event.target.classList.add("active");
        document.getElementById(tabName + "Tab").classList.add("active");
      }

      // Load All Data
      function loadAllData() {
        loadPatients();
        loadAppointments();
        loadDoctors();
      }

      // PATIENTS CRUD
      function loadPatients() {
        const tbody = document.getElementById("patientsBody");
        if (patients.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="6" class="empty-state">No patients found. Add your first patient!</td></tr>';
          return;
        }

        tbody.innerHTML = patients
          .map(
            (p) => `
                <tr>
                    <td>${p.id}</td>
                    <td>${p.name}</td>
                    <td>${p.age}</td>
                    <td>${p.phone}</td>
                    <td>${p.email}</td>
                    <td class="action-btns">
                        <button class="edit-btn" onclick="editPatient(${p.id})">Edit</button>
                        <button class="delete-btn" onclick="deletePatient(${p.id})">Delete</button>
                    </td>
                </tr>
            `
          )
          .join("");
      }

      function openPatientModal(patient = null) {
        editingPatient = patient;
        document.getElementById("patientModalTitle").textContent = patient
          ? "Edit Patient"
          : "Add Patient";

        if (patient) {
          document.getElementById("patientId").value = patient.id;
          document.getElementById("patientName").value = patient.name;
          document.getElementById("patientAge").value = patient.age;
          document.getElementById("patientPhone").value = patient.phone;
          document.getElementById("patientEmail").value = patient.email;
          document.getElementById("patientAddress").value =
            patient.address || "";
        } else {
          document.getElementById("patientForm").reset();
          document.getElementById("patientId").value = "";
        }

        document.getElementById("patientModal").classList.add("active");
      }

      function closePatientModal() {
        document.getElementById("patientModal").classList.remove("active");
        document.getElementById("patientForm").reset();
        editingPatient = null;
      }

      document
        .getElementById("patientForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const patientData = {
            name: document.getElementById("patientName").value,
            age: parseInt(document.getElementById("patientAge").value),
            phone: document.getElementById("patientPhone").value,
            email: document.getElementById("patientEmail").value,
            address: document.getElementById("patientAddress").value,
          };

          if (editingPatient) {
            const index = patients.findIndex((p) => p.id === editingPatient.id);
            patients[index] = { ...patients[index], ...patientData };
          } else {
            const newId =
              patients.length > 0
                ? Math.max(...patients.map((p) => p.id)) + 1
                : 1;
            patients.push({ id: newId, ...patientData });
          }

          loadPatients();
          updateAppointmentSelects();
          closePatientModal();
        });

      function editPatient(id) {
        const patient = patients.find((p) => p.id === id);
        openPatientModal(patient);
      }

      function deletePatient(id) {
        if (confirm("Are you sure you want to delete this patient?")) {
          patients = patients.filter((p) => p.id !== id);
          appointments = appointments.filter((a) => a.patientId !== id);
          loadPatients();
          loadAppointments();
        }
      }

      // APPOINTMENTS CRUD
      function loadAppointments() {
        const tbody = document.getElementById("appointmentsBody");
        if (appointments.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="7" class="empty-state">No appointments found. Schedule your first appointment!</td></tr>';
          return;
        }

        tbody.innerHTML = appointments
          .map((a) => {
            const patient = patients.find((p) => p.id === a.patientId);
            const doctor = doctors.find((d) => d.id === a.doctorId);
            const statusClass =
              a.status === "Completed"
                ? "badge-success"
                : a.status === "Confirmed"
                ? "badge-warning"
                : a.status === "Cancelled"
                ? "badge-danger"
                : "badge-warning";

            return `
                    <tr>
                        <td>${a.id}</td>
                        <td>${patient ? patient.name : "Unknown"}</td>
                        <td>${doctor ? doctor.name : "Unknown"}</td>
                        <td>${a.date}</td>
                        <td>${a.time}</td>
                        <td><span class="badge ${statusClass}">${
              a.status
            }</span></td>
                        <td class="action-btns">
                            <button class="edit-btn" onclick="editAppointment(${
                              a.id
                            })">Edit</button>
                            <button class="delete-btn" onclick="deleteAppointment(${
                              a.id
                            })">Delete</button>
                        </td>
                    </tr>
                `;
          })
          .join("");
      }

      function updateAppointmentSelects() {
        const patientSelect = document.getElementById("appointmentPatient");
        const doctorSelect = document.getElementById("appointmentDoctor");

        patientSelect.innerHTML =
          '<option value="">Select Patient</option>' +
          patients
            .map((p) => `<option value="${p.id}">${p.name}</option>`)
            .join("");

        doctorSelect.innerHTML =
          '<option value="">Select Doctor</option>' +
          doctors
            .map((d) => `<option value="${d.id}">${d.name}</option>`)
            .join("");
      }

      function openAppointmentModal(appointment = null) {
        editingAppointment = appointment;
        updateAppointmentSelects();

        document.getElementById("appointmentModalTitle").textContent =
          appointment ? "Edit Appointment" : "Add Appointment";

        if (appointment) {
          document.getElementById("appointmentId").value = appointment.id;
          document.getElementById("appointmentPatient").value =
            appointment.patientId;
          document.getElementById("appointmentDoctor").value =
            appointment.doctorId;
          document.getElementById("appointmentDate").value = appointment.date;
          document.getElementById("appointmentTime").value = appointment.time;
          document.getElementById("appointmentStatus").value =
            appointment.status;
          document.getElementById("appointmentNotes").value =
            appointment.notes || "";
        } else {
          document.getElementById("appointmentForm").reset();
          document.getElementById("appointmentId").value = "";
        }

        document.getElementById("appointmentModal").classList.add("active");
      }

      function closeAppointmentModal() {
        document.getElementById("appointmentModal").classList.remove("active");
        document.getElementById("appointmentForm").reset();
        editingAppointment = null;
      }

      document
        .getElementById("appointmentForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const appointmentData = {
            patientId: parseInt(
              document.getElementById("appointmentPatient").value
            ),
            doctorId: parseInt(
              document.getElementById("appointmentDoctor").value
            ),
            date: document.getElementById("appointmentDate").value,
            time: document.getElementById("appointmentTime").value,
            status: document.getElementById("appointmentStatus").value,
            notes: document.getElementById("appointmentNotes").value,
          };

          if (editingAppointment) {
            const index = appointments.findIndex(
              (a) => a.id === editingAppointment.id
            );
            appointments[index] = {
              ...appointments[index],
              ...appointmentData,
            };
          } else {
            const newId =
              appointments.length > 0
                ? Math.max(...appointments.map((a) => a.id)) + 1
                : 1;
            appointments.push({ id: newId, ...appointmentData });
          }

          loadAppointments();
          closeAppointmentModal();
        });

      function editAppointment(id) {
        const appointment = appointments.find((a) => a.id === id);
        openAppointmentModal(appointment);
      }

      function deleteAppointment(id) {
        if (confirm("Are you sure you want to delete this appointment?")) {
          appointments = appointments.filter((a) => a.id !== id);
          loadAppointments();
        }
      }

      // DOCTORS CRUD
      function loadDoctors() {
        const tbody = document.getElementById("doctorsBody");
        if (doctors.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="6" class="empty-state">No doctors assigned. Assign your first doctor!</td></tr>';
          return;
        }

        tbody.innerHTML = doctors
          .map(
            (d) => `
                <tr>
                    <td>${d.id}</td>
                    <td>${d.name}</td>
                    <td>${d.specialization}</td>
                    <td>${d.phone}</td>
                    <td>${d.email}</td>
                    <td class="action-btns">
                        <button class="edit-btn" onclick="editDoctor(${d.id})">Edit</button>
                        <button class="delete-btn" onclick="removeDoctor(${d.id})">Remove</button>
                    </td>
                </tr>
            `
          )
          .join("");
      }

      function openDoctorModal(doctor = null) {
        editingDoctor = doctor;
        document.getElementById("doctorModalTitle").textContent = doctor
          ? "Edit Doctor"
          : "Assign Doctor";

        if (doctor) {
          document.getElementById("doctorId").value = doctor.id;
          document.getElementById("doctorName").value = doctor.name;
          document.getElementById("doctorSpecialization").value =
            doctor.specialization;
          document.getElementById("doctorPhone").value = doctor.phone;
          document.getElementById("doctorEmail").value = doctor.email;
        } else {
          document.getElementById("doctorForm").reset();
          document.getElementById("doctorId").value = "";
        }

        document.getElementById("doctorModal").classList.add("active");
      }

      function closeDoctorModal() {
        document.getElementById("doctorModal").classList.remove("active");
        document.getElementById("doctorForm").reset();
        editingDoctor = null;
      }

      document
        .getElementById("doctorForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const doctorData = {
            name: document.getElementById("doctorName").value,
            specialization: document.getElementById("doctorSpecialization")
              .value,
            phone: document.getElementById("doctorPhone").value,
            email: document.getElementById("doctorEmail").value,
          };

          if (editingDoctor) {
            const index = doctors.findIndex((d) => d.id === editingDoctor.id);
            doctors[index] = { ...doctors[index], ...doctorData };
          } else {
            const newId =
              doctors.length > 0
                ? Math.max(...doctors.map((d) => d.id)) + 1
                : 1;
            doctors.push({ id: newId, ...doctorData });
          }

          loadDoctors();
          updateAppointmentSelects();
          closeDoctorModal();
        });

      function editDoctor(id) {
        const doctor = doctors.find((d) => d.id === id);
        openDoctorModal(doctor);
      }

      function removeDoctor(id) {
        if (
          confirm(
            "Are you sure you want to remove this doctor from your assignment?"
          )
        ) {
          doctors = doctors.filter((d) => d.id !== id);
          appointments = appointments.filter((a) => a.doctorId !== id);
          loadDoctors();
          loadAppointments();
        }
      }

      // Initialize
      window.addEventListener("load", function () {
        // Set minimum date for appointments to today
        const today = new Date().toISOString().split("T")[0];
        document.getElementById("appointmentDate").setAttribute("min", today);
      });
    </script>
  </body>
</html>

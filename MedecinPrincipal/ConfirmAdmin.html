<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Confirmer le changement d'administrateur</title>
  <link rel="stylesheet" href="ConfirmAdmin.css" />
</head>
<body>
  <div class="card">
    <h2>Confirmer le changement d'administrateur</h2>
    <p id="selectedDoctor"></p>
    <p>Voulez-vous vraiment rendre ce docteur administrateur ?</p>

    <div class="buttons">
      <button id="cancelBtn">Annuler</button>
      <button id="confirmBtn">Oui</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const selected = localStorage.getItem("selectedAdmin");
      const display = document.getElementById("selectedDoctor");
      const cancelBtn = document.getElementById("cancelBtn");
      const confirmBtn = document.getElementById("confirmBtn");

      
      if (selected) {
        display.textContent = "Docteur sélectionné : " + selected;
      } else {
        display.textContent = "Aucun docteur sélectionné.";
        confirmBtn.disabled = true;
      }

      
      cancelBtn.addEventListener("click", () => {
        window.location.href = "ChooseAdmin.html";
      });

     
      confirmBtn.addEventListener("click", () => {
        if (!selected) {
          alert("Aucun docteur sélectionné !");
          return;
        }

       
        localStorage.setItem("currentAdmin", selected);
        localStorage.removeItem("selectedAdmin");

        
        updateDoctorAdminStatus(selected);

        alert(selected + " est maintenant le nouvel administrateur !");
        
        window.location.href = "ModifyD.html";
      });

      function updateDoctorAdminStatus(adminName) {
        let doctors = JSON.parse(localStorage.getItem('doctors')) || [];
        
        
        doctors = doctors.map(doctor => {
          return {
            ...doctor,
            isAdmin: doctor.name === adminName
          };
        });
        
        localStorage.setItem('doctors', JSON.stringify(doctors));
      }
    });
  </script>
</body>
</html>